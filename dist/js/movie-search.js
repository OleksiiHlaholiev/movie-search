"use strict";"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});var movieSearch=window.movieSearch||{__namespace:!0};!function(e){var t,n=document.getElementById("search-input"),r=document.getElementById("search-btn"),s=document.querySelector(".search-results .item.template"),l=document.querySelector(".search-results .results-cont"),u=document.querySelector(".search-results .results-title"),c=document.querySelector(".pagination"),d=document.querySelector(".pagination .page-item.template"),a=!1,i=function(e){a=!0,t=setTimeout(function(){a=!1,clearTimeout(t),e()},1e3)},o=function(e,t,n){var r,a=new XMLHttpRequest;r="https://api.themoviedb.org/3"+e+"?api_key=62b719d81284900a2580408f52cc3d78"+t,a.open("GET",r,!0),a.send("{}"),a.onreadystatechange=function(){if(4==a.readyState)if(200!=a.status)console.log(a.status+": "+a.statusText);else{var e=JSON.parse(a.responseText);console.log(e),null!=n&&n(e)}}},m=function(e){var t=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"];return t[e]?t[e]:""},v=function(e){var t,r,a,i,o,c;e&&e.results&&(t=e.results,l.innerHTML="",t&&t.length?(u.innerText="Найденные фильмы",t.forEach(function(n,e){(r=s.cloneNode(!0)).classList.remove("template"),r.setAttribute("data-video-id",n.id),r.querySelector(".name").innerText=n.title,i=new Date(n.release_date),o="Invalid Date"!=i?i.getDate()+" "+m(i.getMonth())+" "+i.getFullYear():n.release_date,r.querySelector(".date").innerText=o,r.querySelector(".rating").innerText="Рейтинг: "+n.vote_average,a=200<n.overview.length?n.overview.slice(0,197)+"...":n.overview,r.querySelector(".description").innerText=a,c=500<window.innerWidth?"https://image.tmdb.org/t/p/w185_and_h278_bestv2/":"https://image.tmdb.org/t/p/w350_and_h196_bestv2/",r.querySelector(".img-cont img.poster").setAttribute("src",c+n.poster_path),r.querySelectorAll(".link").forEach(function(e,t){e.setAttribute("href",window.location.href+"details.html?id="+n.id)}),l.appendChild(r)})):u.innerText="По вашему запросу ничего не найдено",g(e.total_pages,e.page,20))},p=function(e){var t;e.currentTarget.classList.contains("disabled")||e.currentTarget.classList.contains("active")||(document.querySelector(".page-item.active").classList.remove("active"),e.currentTarget.classList.add("active"),t=e.currentTarget.getAttribute("data-page"),f(t),document.querySelector(".movie-search-section").scrollIntoView(!0))},g=function(e,t,n){var r,a,i,o;if(h(),c.classList.add("active"),e)for(r=1;r<=e;r++)a=r,i=t,o=void 0,(o=d.cloneNode(!0)).classList.contains("active")&&a!=i&&o.classList.remove("active"),o.setAttribute("data-page",a),o.querySelector(".page-link").innerText=a,o.classList.remove("template"),o.addEventListener("click",p),c.insertBefore(o,c.lastElementChild)},h=function(){var e=document.querySelectorAll(".pagination .page-item:not(.spec)");c.classList.remove("active"),e.length&&e.forEach(function(e,t){e.remove()})},f=function(t){1<=n.value.length&&!a&&t&&i(function(){var e="&query="+n.value+"&language=ru-RU&page="+t;o("/search/movie",e,v)})},y=function(e){f(1)},S=function(e){e.preventDefault(),f(1)};n&&r&&s&&l&&u&&(document.querySelector(".search-results .item.template").remove(),document.querySelector(".pagination .page-item.template").remove()),e.init=function(){n.addEventListener("input",y),r.addEventListener("click",S)},e.getMovieById=function(e,t){e&&o("/movie/"+e,"&language=ru-RU",t)},e.monthDecoder=m}(movieSearch);